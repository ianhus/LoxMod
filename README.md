## LoxMod
This folder contains the R code for the model as well as the necessary inputs. It also contains R codes to evaluate HSIs for wading 
birds and Apple Snails. The files contained within this folder are described below in alphabetical order.

# ADJ_<gridsize>m.csv
These files contain the adjacency vectors for each grid in the domain. Each grid has up to eight adjacent neighbors. Each column in 
the files corresponds to a single grid. That grid's adjacencies are listed clockwise from its northeast neighbor. If no grid occupies 
a given adjacency location, NA is used. For example, the first column in ADJ_400m.csv reads: NA, 2, 6, 5, 4, NA, NA, NA. This indicates 
that grid 1 has no neighbor to the northeast, grid 2 is to east, grid 6 is to the southeast, grid 5 is to the south, and so on. The 
correct adjacency file is read in depending on the value of L that is supplied in the inputs.csv file.
  
# DATA_MATRIX_<gridsize>m.csv
These files contain the properties that are initially assigned to each grid. Each row contains data for a specified grid. GridNo is 
the grid's number. Numbering begins in the northwest corner of the WCA and progresses west-to-east, north-to-south. Yutm is the 
y-coordinate of the center of the grid in meters, relative to NAD83 UTM Zone 17N. Xutm is the x-coordinate in the same coordinate 
system. elev_ft_NG is the elevation assigned to the grid in feet NGVD29. StgJan05 is the intitial stage value assigned to the grid, 
based on an interpolation of all available stage gauge data on 01/01/2005. In the future it might be preferable to get the initial 
stage values from EDEN. Area is the area of the grid, used in water balance calculations. This is based on the number of the original 
400m grids that are contained within each grid at the current resolution. Units for these data are mixed to match the formats available 
from DBHYDRO. Conversions are done within the LoxMod.R code. The string '<gridsize' within the files names takes the place of the grid
spacing used in a given simulation. Possible values are 400, 800, 1600, 3200, 6400. 
  
# Flows05-.csv
This file contains the daily mean flow rates for water control structures surrounding WCA 1. Each row corresponds to a day in the POR 
(01/01/2005 - 12/31/2015). Units are cfs, and are converted to cubic meters in the LoxMod.R program.

# Ga_and_Str_adj_<gridsize>m.csv
These files list the model grids that are adjacent to stage gauges throughout the Refuge (column 1) and the grids that are adjacent 
to the water control structures that interact with the Refuge (column 2). The grids listed in column 1 correspond to Lox North, 1-7, 
1-8T, 1-8C, 1-9, and Lox South, respectively. The order of the water control structures in column two corresponds to the order given 
in Flows05-.csv. 
  
# HSIs-snail.R
This R program calculates the habitat suitability for Apple Snails based on the Depths-<gridsize>.csv file generated by LoxMod.R. This 
program generates an Apple_Snail-<gridsize>.csv file that lists suitability by grid and by year, with each column corresponding to a 
grid, and each row corresponsing to a year. 
  
# HSIs-wbirds.R
This R program calculates the habitat suitability for Apple Snails based on the Depths-<gridsize>.csv file generated by LoxMod.R. This 
program generates an Ibis_Heron-<gridsize>.csv file that lists the domain-aggregated suitability for White Ibises and small herons by 
year. It also generates a Wood_Stork-<gridsize>.csv file that lists the domain-aggregated suitability for Wood Storks by year.
  
# input.csv
This file contains the parameter inputs for the model, including grid size and timestep. Only the first column is read by the LoxMod.R
program. Additional information is included in other columns that is not read into the program. Columns 4-8 contain the optimized values
for each parameter, and those columns can be copy-and-pasted into column 1 to be read by the program. The only L values that work in the
current model are 400, 800, 1600, 3200, 6400. It is recommended that whole numbers of perday are used to avoid rounding errors.
 
# LoxMod.R
This is the R file that predicts stage levels throughout the Refuge. The required inputs are detailed in this document. The model 
writes a Stages-<gridsize>.csv file that lists the stage value for every grid for every day. Each column corresponds to a grid, with
the grid numbers corresponding to the grid numbers given in DATA_MATRIX files. Each row represents one day. A Depths-<gridsize>.csv 
file is also generated, containing the water depth for each grid for each day. The format is the same as the Stages file. 

# LoxWS_ET05-.csv
This file contains the daily PET values from the LOXWS weather station located at the 1-8C gauge. Values are given in millimeters.

# RainT05-.csv
This file contains the daily rainfall totals for the six gauges in and near the Refuge. Each column corresponds to a gauge and each row
corresponds to a day. Values are given in inches. 

# Stage05-.csv
This file contains the daily average stage values at six stage gauges located throughout the Refuge.  Each column corresponds to a gauge
and each row corresponds to a day. The order of the gauges matches the order applied in column 1 of the Ga_and_Str files. Values are 
given in feet NGVD29.

# Thiessen_<gridsize>.csv
These files contain the data needed to use Thiessen polygon rainfall interpolation. Each row corresponds to a grid in the model. The 
numbers listed in the first column indicate which rain gauge is nearest to the corresponding to that row. The number in the second
column indicates the second-nearest gauge, and so on. The number used for each gauge corresponds to the order they are given in the 
RainT05-csv file.
